---
title: 再谈移动端真机调试
date: 2019-09-07 19:26:30
categories: Developer Tools
tags: [前端]
---
### ** Preface **

以前写过一篇[移动端真机调试](http://www.sail.name/2017/07/09/Mobile-debug/)的博客。最近在业务上，做了一个移动端的项目。对调试的手段又多了一种了解，本文做些记录。

******************
### ** 调试方法 **

可以通过配置`webpack`的`devServer`的`host`

```
module.exports = {
  //...
  devServer: {
    host: '0.0.0.0'
  }
};
```

然后使你的电脑和移动设备在同一个网络下(wifi),通过ip:端口，就可以在手机上访问页面。

比如本地浏览器地址栏的开发地址为:`0.0.0.0:8000/test.html`，ip地址为`192.xxx.xx.x`,
现在在移动设备上通过`192.xxx.xx.x:8000/test.html`就可以访问了。

******************

## ** 127.0.0.1、localhost、0.0.0.0 **

这里引入了另一个问题了,为什么0.0.0.0可以进行调试,像localhost为什么就不可以了呢？

### ** IP地址 **

IP地址由两个部分组成，`net-id`和`host-id`，即网络号和主机号。 net-id:表示ip地址所在的网络号。 host-id：表示ip地址所在网络中的某个主机号码。

`IP-address ::=  { <Network-number>, <Host-number> }`

******************
### ** IP地址分类 **

IP地址一共分为5类，即A～E，它们分类的依据是其`net-id`所占的字节长度以及网络号前几位。

- A类地址:网络号占1个字节。网络号的第一位固定为0。
- B类地址：网络号占2个字节。网络号的前两位固定为10。
- C类地址：网络号占3个字节。网络号的前三位固定位110。
- D类地址：前四位是1110，用于多播(multicast)，即一对多通信。
- E类地址：前四位是1111，保留为以后使用。

其中，ABC三类地址为单播地址（unicast),用于一对一通信，是最常用的。
******************
### ** 特殊IP地址 **
特殊IP地址就是用来做一些特殊的事情。RFC1700中定义了以下特殊IP地址。

- {0,0}:网络号和主机号都全部为0，表示“本网络上的本主机”，只能用作源地址。
- {0，host-id}:本网络上的某台主机。只能用作源地址。
- {-1,-1}：表示网络号和主机号的所有位上都是1（二进制），用于本网络上的广播，只能用作目的地址，发到该地址的数据包不能转发到源地址所在网络之外。
- {net-id,-1}:直接广播到指定的网络上。只能用作目的地址。
- {net-id,subnet-id,-1}:直接广播到指定网络的指定子网络上。只用作目的地址。
- {net-id,-1,-1}:直接广播到指定网络的所有子网络上。只能用作目的地址。
- {127，}:即网络号为127的任意ip地址。都是内部主机回环地址(loopback),永远都不能出现在主机外部的网络中。
******************
## ** IPv4 与 IPv6 **

这里还需要提高IPv4与IPv6的概念。像上面提到的`127.0.0.1`、`localhost`、`0.0.0.0`都是IPv4。    
详细可以看这篇博客[IPv4 与 IPv6 的比较](https://www.ibm.com/support/knowledgecenter/zh/ssw_ibm_i_72/rzai2/rzai2compipv4ipv6.htm)。

******************

`127.0.0.1` 与 `0.0.0.0` 都是前面提到的A类地址(A类地址:网络号占1个字节。网络号的第一位固定为0),因为将127转为2进制是
`01111111`。

### ** 127.0.0.1 **

127.0.0.1属于{127,}集合中的一个，而所有网络号为127的地址都被称之为回环地址。
回环地址：所有发往该类地址的数据包都应该被loop back。

** 用途: ** 回环测试,通过使用ping 127.0.0.1 测试某台机器上的网络设备，操作系统或者TCP/IP实现是否工作正常。
** DDos攻击防御: ** 网站收到DDos攻击之后，将域名A记录到127.0.0.1，即让攻击者自己攻击自己。
大部分Web容器测试的时候绑定的本机地址。

******************
### ** localhost **
相比`127.0.0.1`，`localhost`具有更多的意义。`localhost`是个域名，而不是一个ip地址。之所以我们经常把`localhost`与`127.0.0.1`认为是同一个是因为我们使用的大多数电脑上都讲`localhost`指向了`127.0.0.1`这个地址。
在`mac`系统中，`/ets/hosts`文件如下：
```
##
# Host Database
#
# localhost is used to configure the loopback interface
# when the system is booting.  Do not change this entry.
##
127.0.0.1	localhost
255.255.255.255	broadcasthost
::1             localhost

127.0.0.1 windows10.microdone.cn
```
但是`localhost`的意义并不局限于`127.0.0.1`。
`localhost`是一个域名，用于指代`this computer`或者`this host`,可以用它来获取运行在本机上的网络服务。
在大多数系统中，`localhost`被指向了`IPV4`的`127.0.0.1`和`IPV6`的`::1`。

******************
### ** 0.0.0.0 **
`IPV4`中，`0.0.0.0`地址被用于表示一个无效的，未知的或者不可用的目标。

在服务器中，`0.0.0.0`指的是本机上的所有`IPV4`地址，如果一个主机有两个IP地址，`192.168.1.1` 和 `10.1.2.1`，并且该主机上的一个服务监听的地址是`0.0.0.0`,那么通过两个ip地址都能够访问该服务。(** 这也是我们webpack像博客开头那样配置，手机能够访问的原因 **)

在路由中，`0.0.0.0`表示的是默认路由，即当路由表中没有找到完全匹配的路由的时候所对应的路由。

用途总结:
- 当一台主机还没有被分配一个IP地址的时候，用于表示主机本身。（DHCP分配IP地址的时候）
- 用作默认路由，表示”任意IPV4主机”。
- 用来表示目标机器不可用。
- 用作服务端，表示本机上的任意IPV4地址。

******************

### ** 参考链接 **

- [127.0.0.1和0.0.0.0地址的区别](https://juejin.im/post/5d258b6ae51d454f73356dcf)
- [IPv4 与 IPv6 的比较](https://www.ibm.com/support/knowledgecenter/zh/ssw_ibm_i_72/rzai2/rzai2compipv4ipv6.htm)
- [127.0.0.1、localhost、0.0.0.0、本机IP地址](https://gist.github.com/zxhfighter/b9f4b4ef328cd8b433b0e9dc2f4af26d)
- [DevServer](https://webpack.js.org/configuration/dev-server/#devserverhost)